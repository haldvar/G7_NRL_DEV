@model NRL_PROJECT.Models.MapData

@{
    ViewData["Title"] = "Map Confirmation";
    Layout = "_Layout";
}

<div class="max-w-3xl mx-auto px-4 py-10">
    <h1 class="text-3xl font-bold text-purple-700 text-center mb-6">Map Confirmation</h1>

    <p class="text-gray-700 text-center mb-4">Your submitted coordinates have been received and visualized below:</p>

    <div id="mapConfirm" style="height: 400px;" class="rounded shadow mb-6"></div>

    <h2 class="text-lg font-semibold text-purple-700 mb-2">Raw Coordinates</h2>
    <pre class="bg-gray-100 p-4 rounded text-sm text-gray-800">@Model.GeoJsonCoordinates</pre>
</div>

@section Scripts {
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        const map = L.map('mapConfirmation').setView([58.333, 8.233], 13);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        try {
            const coords = @Html.Raw(Json.Serialize(Model.GeoJsonCoordinates));
            const geojson = {
                type: "Feature",
                geometry: {
                    type: "Point", // ← du kan endre til "LineString" hvis aktuelt
                    coordinates: coords
                }
            };

            L.geoJSON(geojson).addTo(map);
            map.fitBounds(L.geoJSON(geojson).getBounds());
        } catch (e) {
            console.error("Invalid GeoJSON:", e);
        }
    </script>
}
