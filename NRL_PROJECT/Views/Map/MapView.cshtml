@model NRL_PROJECT.Models.MapData

@{
    ViewData["Title"] = "Register Map Location";
    Layout = "_Layout";
}
<partial name="_MapDrawPartial" model="Model" />

<!-- Title -->
<h1 class="text-5xl md:text-6xl font-extrabold text-purple-700 text-center mb-4 tracking-wide">
    üó∫Ô∏è Register Map Location
</h1>
<p class="text-gray-600 text-center text-lg md:text-xl mb-12">
    Draw a point or a line on the map below and submit your obstacle.
</p>


  
@section Styles {
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/@@geoman-io/leaflet-geoman-free@latest/dist/leaflet-geoman.css" />
    <!-- Tilpasset styling her -->
}

@section Scripts {
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/@@geoman-io/leaflet-geoman-free@latest/dist/leaflet-geoman.min.js"></script>
    <script>
        const map = L.map('mapDraw').setView([@Model.Latitude, @Model.Longitude], @Model.MapZoomLevel);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        map.pm.addControls({
            position: 'topleft',
            drawMarker: true,
            drawPolyline: true,
            drawPolygon: false,
            drawCircle: false,
            drawRectangle: false,
            editMode: true,
            removalMode: true
        });

        map.on('pm:create', e => {
            const geojson = e.layer.toGeoJSON();
            document.getElementById('geoInput').value = JSON.stringify(geojson.geometry.coordinates);
        });

        map.on('pm:remove', () => {
            document.getElementById('geoInput').value = '';
        });
    </script>
}
